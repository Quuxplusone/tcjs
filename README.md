# tcjs

The goal is to write web front-end completely in C++ instead of JavaScript.
The mean is to create type-safe JavaScript bindings for C++/Emscripten from TypeScript declaration files.

Close analogues are Rust's [stdweb](https://github.com/koute/stdweb) and [wasm-bindgen](https://github.com/rustwasm/wasm-bindgen).

# Dependencies

* [Emscripten](https://emscripten.org/) (Node.js and NPM are included)
* [think-cell public library](https://github.com/think-cell/range)
* Boost 1.68.0 or newer

# Misc thoughts
* C++ callbacks passed to JS are always `noexpect` because exceptions cannot be passed between JS and C++ at the moment.
* Member functions converted to callbacks are always called with a non-const-this.
* Methods for `js_*` types do not have consistent const-qualifiers at the moment, so do not use const qualifiers on them.
* `js_ref` may be inherited from, assuming you're ok with slicing (e.g. `CUniqueDetachableJsFunction`).
  Allowed slicing is argument in favor of `std::is_convertible`/`std::is_constructible`, not
  `tc::is_safely_convertible`, `tc::is_safely_constructible`.
* It may make sense to replace `tc::remove_cvref_t` with `tc::decay_t` in some places so it works with e.g. `vector<bool>::reference`.
* It may make sense to decay subtypes of `js_ref` to `js_ref`.
* `js_union` currently does not force any specific order of arguments, probably it should to some extent
  (even though most instances will be autogenerated).
* Standard `std::variant` construction is somewhat more restrictive than `js_union`:
  the former requires successful overload resolution, the latter requires that the
  argument is convertible to at least one option.
